name: Package App

on:
  push:
    branches: [ "main" ]
  pull_request:
    branches: [ "main" ]

jobs:

  build:

    runs-on: ubuntu-latest

    steps:
    - uses: actions/checkout@v4
    - name: List
      run: pwd && ls -l
    - name: Install UCC
      run: pip install splunk-add-on-ucc-framework && pip freeze
    - name: Build component lib
      run: pwd && cd packages/my-react-component && npm install
    - name: Yarn setup
      run: pwd && yarn setup
    - name: Package App
      run: cd integration_test && ./package.sh
    - uses: actions/upload-artifact@v4
      with:
        path: integration_test/ctis.tar.gz
    - name: Release
      uses: softprops/action-gh-release@v2
      with:
        body: Release ${{github.sha}}
        files: integration_test/ctis.tar.gz
        
    #- name: Spin up Splunk docker
     # run: cd integration_test && ./spin-up-docker-splunk.sh
      
